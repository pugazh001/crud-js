<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Medicine Management App</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
  #main-content > div { display: none; }
  #main-content > div.active { display: block; }
  .clickable { cursor: pointer; }
</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg bg-body-tertiary" id="main-navbar" data-bs-theme="light">
  <div class="container-fluid">
    <a class="navbar-brand clickable" onclick="showHome()">MedicineApp</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="nav-links">
        <li class="nav-item"><a class="nav-link clickable" onclick="showHome()">Home</a></li>
        <li class="nav-item"><a class="nav-link clickable" onclick="showAddProduct()">Add Product</a></li>
        <li class="nav-item"><a class="nav-link clickable" onclick="showMyProducts()">My Products</a></li>
        <li class="nav-item"><a class="nav-link clickable" onclick="showMedicineTable()">Medicine Table</a></li>
        <li class="nav-item"><a class="nav-link clickable" onclick="showProfile()">Profile</a></li>
      </ul>
      <div class="d-flex align-items-center gap-3">
        <button class="btn btn-outline-secondary btn-sm" id="theme-toggle" onclick="toggleTheme()">🌙</button>
        <span id="user-name" class="me-3"></span>
        <button class="btn btn-danger btn-sm" onclick="logout()">Logout</button>
      </div>
    </div>
  </div>
</nav>

<!-- Authentication Section -->
<div class="container mt-5" id="auth-section">
  <!-- Login Form -->
  <form id="login-form" style="max-width:400px; margin:auto;">
    <h3 class="mb-3 text-center">Login</h3>
    <div class="mb-3">
      <label for="login-email" class="form-label">Email address</label>
      <input type="email" class="form-control" id="login-email" required />
    </div>
    <div class="mb-3">
      <label for="login-password" class="form-label">Password</label>
      <input type="password" class="form-control" id="login-password" required />
    </div>
    <button type="submit" class="btn btn-primary w-100">Login</button>
    <p class="mt-3 text-center">
      New here? <a href="#" id="show-signup-link">Sign up</a>
    </p>
  </form>

  <!-- Signup Form -->
  <form id="signup-form" style="max-width:400px; margin:auto; display:none;">
    <h3 class="mb-3 text-center">Sign Up</h3>
    <div class="mb-3">
      <label for="signup-name" class="form-label">Name</label>
      <input type="text" class="form-control" id="signup-name" required />
    </div>
    <div class="mb-3">
      <label for="signup-email" class="form-label">Email address</label>
      <input type="email" class="form-control" id="signup-email" required />
    </div>
    <div class="mb-3">
      <label for="signup-password" class="form-label">Password</label>
      <input type="password" class="form-control" id="signup-password" required />
    </div>
    <button type="submit" class="btn btn-success w-100">Register</button>
    <p class="mt-3 text-center">
      Already have an account? <a href="#" id="show-login-link">Login</a>
    </p>
  </form>
</div>

<!-- Main Content -->
<div class="container mt-4" id="main-content" style="display:none;">

  <!-- Home -->
  <div id="home" class="active">
    <h2>Welcome to MedicineApp</h2>
    <div class="row" id="home-cards">
      <!-- 5 cards will be generated here -->
    </div>
  </div>

  <!-- Add Product -->
  <div id="add-product">
    <h2>Add Product</h2>
    <form id="add-product-form" style="max-width:500px;">
      <div class="mb-3">
        <label for="product-name" class="form-label">Product Name</label>
        <input type="text" id="product-name" class="form-control" required />
      </div>
      <div class="mb-3">
        <label for="product-description" class="form-label">Description</label>
        <textarea id="product-description" class="form-control" rows="3"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Add Product</button>
    </form>
  </div>

  <!-- My Products -->
  <div id="my-products">
    <h2>My Products</h2>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody id="product-list"></tbody>
    </table>
  </div>

  <!-- Medicine Table -->
  <div id="medicine-table">
    <h2>Medicine Table</h2>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Medicine Name</th>
          <th>Use</th>
          <th>Price</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Paracetamol</td><td>Pain relief</td><td>$5</td></tr>
        <tr><td>Ibuprofen</td><td>Anti-inflammatory</td><td>$8</td></tr>
        <tr><td>Amoxicillin</td><td>Antibiotic</td><td>$15</td></tr>
        <tr><td>Omeprazole</td><td>Acid Reducer</td><td>$12</td></tr>
        <tr><td>Vitamin C</td><td>Immune support</td><td>$7</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Profile Page -->
  <div id="profile-page">
    <h2>Your Profile</h2>
    <form id="profile-form" style="max-width:400px;">
      <div class="mb-3">
        <label for="profile-name" class="form-label">Name</label>
        <input type="text" id="profile-name" class="form-control" required />
      </div>
      <div class="mb-3">
        <label for="profile-email" class="form-label">Email (Read Only)</label>
        <input type="email" id="profile-email" class="form-control" readonly />
      </div>
      <button type="submit" class="btn btn-primary">Update Profile</button>
    </form>
  </div>

</div>

<!-- Edit Product Modal -->
<div class="modal fade" id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel"
  aria-hidden="true">
  <div class="modal-dialog">
    <form class="modal-content" id="edit-product-form">
      <div class="modal-header">
        <h5 class="modal-title" id="editProductModalLabel">Edit Product</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="edit-product-id" />
        <div class="mb-3">
          <label for="edit-product-name" class="form-label">Product Name</label>
          <input type="text" class="form-control" id="edit-product-name" required />
        </div>
        <div class="mb-3">
          <label for="edit-product-description" class="form-label">Description</label>
          <textarea class="form-control" id="edit-product-description" rows="3"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">Save Changes</button>
      </div>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Helper: show only one main section
  function showSection(sectionId) {
    document.getElementById('auth-section').style.display = 'none';
    document.getElementById('main-content').style.display = 'block';
    const sections = ['home', 'add-product', 'my-products', 'medicine-table', 'profile-page'];
    sections.forEach(sec => {
      document.getElementById(sec).classList.remove('active');
    });
    document.getElementById(sectionId).classList.add('active');
  }

  // Navigation functions
  function showHome() {
    loadHomeCards();
    showSection('home');
  }
  function showAddProduct() { showSection('add-product'); }
  function showMyProducts() {
    loadProductList();
    showSection('my-products');
  }
  function showMedicineTable() { showSection('medicine-table'); }
  function showProfile() {
    let user = JSON.parse(localStorage.getItem('user'));
    if (user) {
      document.getElementById('profile-name').value = user.name;
      document.getElementById('profile-email').value = user.email;
    }
    showSection('profile-page');
  }

  // Show login/signup toggle
  document.getElementById('show-signup-link').onclick = e => {
    e.preventDefault();
    document.getElementById('login-form').style.display = 'none';
    document.getElementById('signup-form').style.display = 'block';
  };
  document.getElementById('show-login-link').onclick = e => {
    e.preventDefault();
    document.getElementById('signup-form').style.display = 'none';
    document.getElementById('login-form').style.display = 'block';
  };

  // Signup form submit
  document.getElementById('signup-form').onsubmit = function(e) {
    e.preventDefault();
    let name = document.getElementById('signup-name').value.trim();
    let email = document.getElementById('signup-email').value.trim().toLowerCase();
    let password = document.getElementById('signup-password').value;

    if (!name || !email || !password) {
      alert('Please fill all fields');
      return;
    }
    // Save user in localStorage (only one user for simplicity)
    let user = { name, email, password, products: [] };
    localStorage.setItem('user', JSON.stringify(user));
    localStorage.setItem('loggedIn', 'true');
    prepareUIForLoggedInUser();
    showHome();
  };

  // Login form submit
  document.getElementById('login-form').onsubmit = function(e) {
    e.preventDefault();
    let email = document.getElementById('login-email').value.trim().toLowerCase();
    let password = document.getElementById('login-password').value;
    let user = JSON.parse(localStorage.getItem('user'));
    if (!user) {
      alert('No user found, please register first.');
      return;
    }
    if (user.email === email && user.password === password) {
      localStorage.setItem('loggedIn', 'true');
      prepareUIForLoggedInUser();
      showHome();
    } else {
      alert('Incorrect email or password');
    }
  };

  // Load user's products in table
  function loadProductList() {
    let user = JSON.parse(localStorage.getItem('user'));
    let tbody = document.getElementById('product-list');
    tbody.innerHTML = '';
    if (!user || !user.products || user.products.length === 0) {
      tbody.innerHTML = '<tr><td colspan="4" class="text-center">No products added.</td></tr>';
      return;
    }
    user.products.forEach((prod, i) => {
      let tr = document.createElement('tr');
      tr.innerHTML = `<td>${prod.name}</td>
                      <td>${prod.description}</td>
                      <td class="text-center"><i class="bi bi-pencil-square clickable" title="Edit" onclick="editProduct(${i})">&#9998;</i></td>
                      <td class="text-center"><i class="bi bi-trash clickable" title="Delete" onclick="deleteProduct(${i})">&#10060;</i></td>`;
      tbody.appendChild(tr);
    });
  }

  // Add product submission
  document.getElementById('add-product-form').onsubmit = function(e) {
    e.preventDefault();
    let name = document.getElementById('product-name').value.trim();
    let description = document.getElementById('product-description').value.trim();

    if (!name) {
      alert('Product name is required');
      return;
    }

    let user = JSON.parse(localStorage.getItem('user'));
    if (!user.products) user.products = [];
    user.products.push({ name, description });
    localStorage.setItem('user', JSON.stringify(user));
    document.getElementById('add-product-form').reset();
    alert('Product added successfully');
  };

  // Edit product modal handling
  var editModal = new bootstrap.Modal(document.getElementById('editProductModal'));
  function editProduct(index) {
    let user = JSON.parse(localStorage.getItem('user'));
    let product = user.products[index];
    document.getElementById('edit-product-id').value = index;
    document.getElementById('edit-product-name').value = product.name;
    document.getElementById('edit-product-description').value = product.description;
    editModal.show();
  }
  document.getElementById('edit-product-form').onsubmit = function(e) {
    e.preventDefault();
    let index = parseInt(document.getElementById('edit-product-id').value);
    let name = document.getElementById('edit-product-name').value.trim();
    let description = document.getElementById('edit-product-description').value.trim();
    if (!name) {
      alert('Product name is required.');
      return;
    }
    let user = JSON.parse(localStorage.getItem('user'));
    user.products[index] = { name, description };
    localStorage.setItem('user', JSON.stringify(user));
    loadProductList();
    editModal.hide();
  };

  // Delete product
  function deleteProduct(index) {
    if (!confirm('Are you sure you want to delete this product?')) return;
    let user = JSON.parse(localStorage.getItem('user'));
    user.products.splice(index, 1);
    localStorage.setItem('user', JSON.stringify(user));
    loadProductList();
  }

  // Load home cards - static example cards for demo
  function loadHomeCards() {
    let cardContainer = document.getElementById('home-cards');
    cardContainer.innerHTML = '';
    const cardsData = [
      { title: 'Paracetamol', text: 'Pain relief medicine' },
      { title: 'Ibuprofen', text: 'Anti-inflammatory' },
      { title: 'Amoxicillin', text: 'Antibiotic' },
      { title: 'Omeprazole', text: 'Acid reducer' },
      { title: 'Vitamin C', text: 'Immune support' }
    ];
    cardsData.forEach(card => {
      let col = document.createElement('div');
      col.className = 'col-md-4 col-lg-2 mb-3';
      col.innerHTML = `<div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">${card.title}</h5>
          <p class="card-text">${card.text}</p>
        </div>
      </div>`;
      cardContainer.appendChild(col);
    });
  }

  // Profile update
  document.getElementById('profile-form').onsubmit = function(e) {
    e.preventDefault();
    let name = document.getElementById('profile-name').value.trim();
    if (!name) {
      alert('Name cannot be empty');
      return;
    }
    let user = JSON.parse(localStorage.getItem('user'));
    user.name = name;
    localStorage.setItem('user', JSON.stringify(user));
    alert('Profile updated');
    prepareUIForLoggedInUser();
  };

  // Logout user
  function logout() {
    localStorage.removeItem('loggedIn');
    // could keep user data but remove loggedIn flag
    document.getElementById('main-content').style.display = 'none';
    document.getElementById('auth-section').style.display = 'block';
    document.getElementById('login-form').style.display = 'block';
    document.getElementById('signup-form').style.display = 'none';
    document.getElementById('user-name').textContent = '';
  }

  // Dark/light theme management
  function toggleTheme() {
    let navbar = document.getElementById('main-navbar');
    let currentTheme = navbar.getAttribute('data-bs-theme');
    let newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    navbar.setAttribute('data-bs-theme', newTheme);
    document.body.setAttribute('data-bs-theme', newTheme);
    document.getElementById('theme-toggle').textContent = newTheme === 'dark' ? '☀️' : '🌙';
    localStorage.setItem('theme', newTheme);
  }

  function applySavedTheme() {
    let theme = localStorage.getItem('theme') || 'light';
    document.getElementById('main-navbar').setAttribute('data-bs-theme', theme);
    document.body.setAttribute('data-bs-theme', theme);
    document.getElementById('theme-toggle').textContent = theme === 'dark' ? '☀️' : '🌙';
  }

  // When logged in, show user name on navbar
  function prepareUIForLoggedInUser() {
    let user = JSON.parse(localStorage.getItem('user'));
    if (user && user.name) {
      document.getElementById('user-name').textContent = user.name;
    }
    // Show nav links
    document.getElementById('nav-links').style.display = 'flex';
    applySavedTheme();
  }

  // Initial onload check
  window.onload = function () {
    let loggedIn = localStorage.getItem('loggedIn');
    if (loggedIn === 'true') {
      document.getElementById('auth-section').style.display = 'none';
      document.getElementById('main-content').style.display = 'block';
      prepareUIForLoggedInUser();
      showHome();
    } else {
      document.getElementById('auth-section').style.display = 'block';
      document.getElementById('main-content').style.display = 'none';
      document.getElementById('login-form').style.display = 'block';
      document.getElementById('signup-form').style.display = 'none';
      document.getElementById('nav-links').style.display = 'none';
    }
  };
</script>

<!-- Bootstrap Icons CDN for edit/delete icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />

</body>
</html>
